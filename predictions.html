<hr>
<p>jupyter:
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
  language_info:
    codemirror_mode:
      name: ipython
      version: 3
    file_extension: .py
    mimetype: text/x-python
    name: python
    nbconvert_exporter: python
    pygments_lexer: ipython3
    version: 3.9.6
  nbformat: 4
  nbformat_minor: 2
  orig_nbformat: 4
  vscode:
    interpreter:</p>
<pre><code>  <span class="hljs-built_in">hash</span>: b671c20432fcd147198c92e7f072af9e705f087eb990bee22b07f08caab9f630
</code></pre><hr>
<p>::: {.cell .markdown}
<strong>Natural Language Processing with Disaster Tweets</strong>
:::</p>
<p>::: {.cell .markdown}
The following code is for the
<code>&lt;a href =&quot;https://www.kaggle.com/competitions/nlp-getting-started/data?select=sample_submission.csv&quot;&gt;</code>{=html}
Kaggle NLP prediction <code>&lt;/a&gt;</code>{=html} that I particpated in.</p>
<p>The task: You are predicting whether a given tweet is about a real
disaster or not. If so, predict a 1. If not, predict a 0 <code>&lt;br&gt;</code>{=html}
The files involved were: <code>&lt;ul&gt;</code>{=html} <code>&lt;li&gt;</code>{=html}- Train.csv [The
training dataset]<code>&lt;/li&gt;</code>{=html} <code>&lt;li&gt;</code>{=html}- Test.csv [The test
dataset]<code>&lt;/li&gt;</code>{=html} <code>&lt;li&gt;</code>{=html}- Submission.csv [The submission
dataset]<code>&lt;/li&gt;</code>{=html} <code>&lt;/ul&gt;</code>{=html}
:::</p>
<p>::: {.cell .markdown}
Loading the necessary libraries and the datasets
:::</p>
<p>::: {.cell .code execution_count=&quot;56&quot;}</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd    # <span class="hljs-keyword">data</span> processing
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np   #linear algebra
<span class="hljs-keyword">import</span> nltk
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
from sklearn <span class="hljs-keyword">import</span> feature_extraction, linear_model,model_selection, preprocessing #Machine learning models
</code></pre>
<p>:::</p>
<p>::: {.cell .code execution_count=&quot;57&quot;}</p>
<pre><code class="lang-python">#loading the train dataset 
train_dis = pd.read_csv('C:<span class="hljs-symbol">\\</span>train.csv')
train_dis.head()
</code></pre>
<p>::: {.output .execute_result execution_count=&quot;57&quot;}</p>
<pre><code class="lang-{=html}"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">06850890-4770-4d57-9d96-d5b3a3ea7dfe</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display:none; background-color:#9D6CFF; color:white; width:200px; height:30px; padding-left:5px; border-radius:4px; flex-direction:row; justify-content:space-around; align-items:center;"</span> <span class="hljs-attr">onmouseover</span>=<span class="hljs-string">"this.style.backgroundColor='#BA9BF8'"</span> <span class="hljs-attr">onmouseout</span>=<span class="hljs-string">"this.style.backgroundColor='#9D6CFF'"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"window.commands?.execute('create-mitosheet-from-dataframe-output');"</span>&gt;</span>See Full Dataframe in Mito<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.commands?.hasCommand(<span class="hljs-string">'create-mitosheet-from-dataframe-output'</span>)) <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'06850890-4770-4d57-9d96-d5b3a3ea7dfe'</span>).style.display = <span class="hljs-string">'flex'</span> </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">border</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dataframe"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"text-align: right;"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>id<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>keyword<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>location<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>text<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>target<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Our Deeds are the Reason of this #earthquake May ALLAH Forgive us all<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>4<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Forest fire near La Ronge Sask. Canada<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>5<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>All residents asked to 'shelter in place' are being notified by officers. No other evacuation or shelter in place orders are expected<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>6<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>13,000 people receive #wildfires evacuation orders in California<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>4<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>7<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Just got sent this photo from Ruby #Alaska as smoke from #wildfires pours into a school<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>:::
:::</p>
<p>::: {.cell .code execution_count=&quot;58&quot;}</p>
<pre><code class="lang-python">#loading the test dataset
test_dis = pd.read_csv('C:<span class="hljs-symbol">\\</span>Users<span class="hljs-symbol">\\</span>train.csv')
test_dis.head()
</code></pre>
<p>::: {.output .execute_result execution_count=&quot;58&quot;}</p>
<pre><code class="lang-{=html}"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">6c718b7f-84ce-4e8e-8aaf-b5e76d71cb66</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display:none; background-color:#9D6CFF; color:white; width:200px; height:30px; padding-left:5px; border-radius:4px; flex-direction:row; justify-content:space-around; align-items:center;"</span> <span class="hljs-attr">onmouseover</span>=<span class="hljs-string">"this.style.backgroundColor='#BA9BF8'"</span> <span class="hljs-attr">onmouseout</span>=<span class="hljs-string">"this.style.backgroundColor='#9D6CFF'"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"window.commands?.execute('create-mitosheet-from-dataframe-output');"</span>&gt;</span>See Full Dataframe in Mito<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.commands?.hasCommand(<span class="hljs-string">'create-mitosheet-from-dataframe-output'</span>)) <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'6c718b7f-84ce-4e8e-8aaf-b5e76d71cb66'</span>).style.display = <span class="hljs-string">'flex'</span> </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">border</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dataframe"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"text-align: right;"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>id<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>keyword<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>location<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>text<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>target<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Our Deeds are the Reason of this #earthquake May ALLAH Forgive us all<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>4<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Forest fire near La Ronge Sask. Canada<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>5<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>All residents asked to 'shelter in place' are being notified by officers. No other evacuation or shelter in place orders are expected<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>6<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>13,000 people receive #wildfires evacuation orders in California<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>4<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>7<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Just got sent this photo from Ruby #Alaska as smoke from #wildfires pours into a school<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>:::
:::</p>
<p>::: {.cell .code execution_count=&quot;59&quot;}</p>
<pre><code class="lang-python"><span class="hljs-selector-id">#Checking</span> <span class="hljs-selector-tag">for</span> <span class="hljs-selector-tag">nulls</span> 
<span class="hljs-selector-tag">train_dis</span><span class="hljs-selector-class">.isnull</span>()<span class="hljs-selector-class">.sum</span>()
</code></pre>
<p>::: {.output .execute_result execution_count=&quot;59&quot;}
    id             0
    keyword       61
    location    2533
    text           0
    target         0
    dtype: int64
:::
:::</p>
<p>::: {.cell .markdown}
The columns missing data are keyword and location <code>&lt;br&gt;</code>{=html} The
Keyword column shows the \&quot;word\&quot; from the tweets that stood out the
most such as \&quot;He set her house ablaze\&quot; <code>&lt;br&gt;</code>{=html} The Keyword will
be \&quot;Ablaze\&quot;</p>
<p>Location column shows where the tweet come from
:::</p>
<p>::: {.cell .markdown}
<strong>Data Cleaning and Exploratory Data Analysis</strong>
:::</p>
<p>::: {.cell .code execution_count=&quot;60&quot;}</p>
<pre><code class="lang-python"><span class="hljs-section">#Sample of what a positive tweet and negative tweet looks like</span>
positive=train<span class="hljs-emphasis">_dis[train_</span>dis[<span class="hljs-string">'target'</span>]==0]["text"].values[1]
negative=train<span class="hljs-emphasis">_dis[train_</span>dis[<span class="hljs-string">'target'</span>]==1]["text"].values[1]


print('This is a positive tweet:\n',positive ,'\nThis is a negative tweet:\n',negative)
</code></pre>
<p>::: {.output .stream .stdout}
    This is a positive tweet:
     I love fruits 
    This is a negative tweet:
     Forest fire near La Ronge Sask. Canada
:::
:::</p>
<p>::: {.cell .markdown}
I combined the keyword column and the text column to come up with the
tweet column for the train and test data set. This adds more weight to
the tweet column for the values that don\&#39;t have a blank keyword rows
:::</p>
<p>::: {.cell .code execution_count=&quot;61&quot;}</p>
<pre><code class="lang-python">
# combine columns <span class="hljs-symbol">A</span> and <span class="hljs-symbol">B</span> with a space in between, if <span class="hljs-symbol">A</span> is not null, otherwise keep <span class="hljs-symbol">B</span> unchanged
train_dis[<span class="hljs-string">'tweet'</span>] = np.where(train_dis[<span class="hljs-string">'text'</span>].notnull(), train_dis[<span class="hljs-string">'text'</span>].astype(str) + <span class="hljs-string">' '</span> + train_dis[<span class="hljs-string">'keyword'</span>].astype(str), train_dis[<span class="hljs-string">'keyword'</span>])
train_dis[<span class="hljs-string">'tweet'</span>] = train_dis[<span class="hljs-string">'tweet'</span>].str.replace(<span class="hljs-string">'nan'</span>,<span class="hljs-string">''</span>)

#<span class="hljs-symbol">Viewing</span> rows where the keywords are not null
df_not_null = train_dis[train_dis[<span class="hljs-string">'keyword'</span>].notnull()]

df_not_null[[<span class="hljs-string">'keyword'</span> ,<span class="hljs-string">'tweet'</span>]]
</code></pre>
<p>::: {.output .execute_result execution_count=&quot;61&quot;}</p>
<pre><code class="lang-{=html}"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">e52f9306-d6a3-42d0-8e71-6958aadb0c20</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display:none; background-color:#9D6CFF; color:white; width:200px; height:30px; padding-left:5px; border-radius:4px; flex-direction:row; justify-content:space-around; align-items:center;"</span> <span class="hljs-attr">onmouseover</span>=<span class="hljs-string">"this.style.backgroundColor='#BA9BF8'"</span> <span class="hljs-attr">onmouseout</span>=<span class="hljs-string">"this.style.backgroundColor='#9D6CFF'"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"window.commands?.execute('create-mitosheet-from-dataframe-output');"</span>&gt;</span>See Full Dataframe in Mito<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.commands?.hasCommand(<span class="hljs-string">'create-mitosheet-from-dataframe-output'</span>)) <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'e52f9306-d6a3-42d0-8e71-6958aadb0c20'</span>).style.display = <span class="hljs-string">'flex'</span> </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">border</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dataframe"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"text-align: right;"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>keyword<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>tweet<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>31<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>ablaze<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>@bbcmtd Wholesale Markets ablaze http://t.co/lHYXEOHY6C ablaze<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>32<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>ablaze<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>We always try to bring the heavy. #metal #RT http://t.co/YAo1e0xngw ablaze<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>33<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>ablaze<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>#AFRICANBAZE: Breaking news:Nigeria flag set ablaze in Aba. http://t.co/2nndBGwyEi ablaze<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>34<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>ablaze<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Crying out for more! Set me ablaze ablaze<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>35<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>ablaze<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>On plus side LOOK AT THE SKY LAST NIGHT IT WAS ABLAZE http://t.co/qqsmshaJ3N ablaze<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>7578<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>wrecked<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>@jt_ruff23 @cameronhacker and I wrecked you both wrecked<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>7579<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>wrecked<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Three days off from work and they've pretty much all been wrecked hahaha shoutout to my family for that one wrecked<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>7580<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>wrecked<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>#FX #forex #trading Cramer: Iger's 3 words that wrecked Disney's stock http://t.co/7enNulLKzM wrecked<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>7581<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>wrecked<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>@engineshed Great atmosphere at the British Lion gig tonight. Hearing is wrecked. http://t.co/oMNBAtJEAO wrecked<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>7582<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>wrecked<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Cramer: Iger's 3 words that wrecked Disney's stock - CNBC http://t.co/N6RBnHMTD4 wrecked<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>:::
:::</p>
<p>::: {.cell .code execution_count=&quot;62&quot;}</p>
<pre><code class="lang-python">#<span class="hljs-symbol">We</span> do the same for the test data since we are using the same logic
test_dis[<span class="hljs-string">'tweet'</span>] = np.where(test_dis[<span class="hljs-string">'text'</span>].notnull(), test_dis[<span class="hljs-string">'text'</span>].astype(str) + <span class="hljs-string">' '</span> + test_dis[<span class="hljs-string">'keyword'</span>].astype(str), test_dis[<span class="hljs-string">'keyword'</span>])
test_dis[<span class="hljs-string">'tweet'</span>] = test_dis[<span class="hljs-string">'tweet'</span>].str.replace(<span class="hljs-string">'nan'</span>,<span class="hljs-string">''</span>)
</code></pre>
<p>:::</p>
<p>::: {.cell .code execution_count=&quot;63&quot;}</p>
<pre><code class="lang-python">#Lets <span class="hljs-keyword">go</span> back <span class="hljs-keyword">to</span> our dataset <span class="hljs-built_in">and</span> <span class="hljs-keyword">drop</span> the text column
train_dis.<span class="hljs-keyword">drop</span>(<span class="hljs-string">'text'</span>,axis=<span class="hljs-number">1</span>,inplace=True)
train_dis.head(<span class="hljs-number">5</span>)
</code></pre>
<p>::: {.output .execute_result execution_count=&quot;63&quot;}</p>
<pre><code class="lang-{=html}"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">d680bb58-810f-4fe4-97b1-ca5c5d965437</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display:none; background-color:#9D6CFF; color:white; width:200px; height:30px; padding-left:5px; border-radius:4px; flex-direction:row; justify-content:space-around; align-items:center;"</span> <span class="hljs-attr">onmouseover</span>=<span class="hljs-string">"this.style.backgroundColor='#BA9BF8'"</span> <span class="hljs-attr">onmouseout</span>=<span class="hljs-string">"this.style.backgroundColor='#9D6CFF'"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"window.commands?.execute('create-mitosheet-from-dataframe-output');"</span>&gt;</span>See Full Dataframe in Mito<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.commands?.hasCommand(<span class="hljs-string">'create-mitosheet-from-dataframe-output'</span>)) <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'d680bb58-810f-4fe4-97b1-ca5c5d965437'</span>).style.display = <span class="hljs-string">'flex'</span> </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">border</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dataframe"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"text-align: right;"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>id<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>keyword<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>location<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>target<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>tweet<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Our Deeds are the Reason of this #earthquake May ALLAH Forgive us all<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>4<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Forest fire near La Ronge Sask. Canada<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>5<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>All residents asked to 'shelter in place' are being notified by officers. No other evacuation or shelter in place orders are expected<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>6<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>13,000 people receive #wildfires evacuation orders in California<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>4<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>7<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>NaN<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>Just got sent this photo from Ruby #Alaska as smoke from #wildfires pours into a school<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>:::
:::</p>
<p>::: {.cell .markdown}
<strong>Exploratory Data Analysis</strong>
:::</p>
<p>::: {.cell .markdown}
A wordcloud provides the visual perspective needed to get a sense of the
words that were used the most.
:::</p>
<p>::: {.cell .code execution_count=&quot;77&quot;}</p>
<pre><code class="lang-python"><span class="hljs-built_in">from</span> wordcloud import WordCloud

<span class="hljs-comment">#replace empty values with an empty string</span>
train_dis[<span class="hljs-string">'keyword'</span>].fillna(<span class="hljs-string">''</span>,inplace=True)


<span class="hljs-comment">#concatenate all text in the column into one string</span>
<span class="hljs-keyword">text</span> = <span class="hljs-string">' '</span>.join(train_dis[<span class="hljs-string">'keyword'</span>].tolist())

<span class="hljs-comment">#create a wordcloud from the text</span>
wordcloud = WordCloud().generate(<span class="hljs-keyword">text</span>)

<span class="hljs-comment">#plot the wordcloud</span>
plt.imshow(wordcloud, interpolation=<span class="hljs-string">'bilinear'</span>)
plt.axis(<span class="hljs-string">'off'</span>)
plt.show()
</code></pre>
<p>::: {.output .display_data}
<img src="vertopal_3190e16055c1495785ea62c5235a8d0b/2e01e38af6a69aa9e8931869c0a1ce23fffb1ebd.png" alt="">
:::
:::</p>
<p>::: {.cell .markdown}
<strong>Data Preprocessing</strong>
:::</p>
<p>::: {.cell .markdown}
We first begin by turning the column into data that the model can
process. This can be done through COUNT VECTORIZER which counts the
words and turns them into a vector which is a set of numbers that an ML
model can work with
:::</p>
<p>::: {.cell .code execution_count=&quot;65&quot;}</p>
<pre><code class="lang-python">count<span class="hljs-emphasis">_vectorizer = feature_</span>extraction.text.CountVectorizer()

<span class="hljs-section">#Counts for the first 5 tweets</span>
example<span class="hljs-emphasis">_train = count_</span>vectorizer.fit<span class="hljs-emphasis">_transform(train_</span>dis[<span class="hljs-string">"tweet"</span>][<span class="hljs-symbol">0:5</span>])
example_train
</code></pre>
<p>::: {.output .execute_result execution_count=&quot;65&quot;}
    <5x54 sparse matrix of type '<class 'numpy.int64'>'
        with 61 stored elements in Compressed Sparse Row format>
:::
:::</p>
<p>::: {.cell .markdown}
The .todense() method is used to convert a sparse matrix to a dense
matrix. A sparse matrix is a matrix where most of the elements are zero.
To store this matrix efficiently, it is stored in a sparse format, which
only stores the non-zero elements.</p>
<p>The .todense() method converts this sparse representation of the matrix
to a dense matrix, which stores all elements including the zeros. This
conversion is useful when you want to perform computations or operations
that require the full matrix representation, or when you want to
visualize the matrix.</p>
<p>However, converting a sparse matrix to a dense matrix can be
memory-intensive, especially if the matrix is large and has a high
number of non-zero elements. So, it\&#39;s recommended to use sparse
matrices wherever possible, and only use .todense() when necessary.
:::</p>
<p>::: {.cell .code execution_count=&quot;66&quot;}</p>
<pre><code class="lang-python">print(<span class="hljs-name">example_train</span>[<span class="hljs-number">0</span>].todense().shape)
print(<span class="hljs-name">example_train</span>[<span class="hljs-number">0</span>].todense())
</code></pre>
<p>::: {.output .stream .stdout}
    (1, 54)
    [[0 0 0 1 1 1 0 0 0 0 0 0 1 1 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 1 0 0 0 0 1 0
      0 0 0 1 0 0 0 0 0 0 0 0 0 1 1 0 1 0]]
:::
:::</p>
<p>::: {.cell .markdown}
This means that there is 54 unique words( or \&quot;tokens\&quot;) in the first 5
tweets and the first tweet contains only some of those unique tokens -
all the 1\&#39;s above are the tokens that exist in the first tweet
:::</p>
<p>::: {.cell .code execution_count=&quot;67&quot;}</p>
<pre><code class="lang-python"><span class="hljs-comment">#Creating the vectors for the tweets</span>
<span class="hljs-attr">train_vectors</span> = count_vectorizer.fit_transform(train_dis[<span class="hljs-string">"tweet"</span>])
</code></pre>
<p>:::</p>
<p>::: {.cell .markdown}
We are not using .fit_transform() because using .transform() makes sure
that the tokens in the train vectors are the only ones mapped to the
test vectors : the train and test vectors use the same set of tokens</p>
<p>Also the test data just needs to be transformed not fit
:::</p>
<p>::: {.cell .code execution_count=&quot;68&quot;}</p>
<pre><code class="lang-python"><span class="hljs-attr">test_vectors</span> = count_vectorizer.transform(test_dis[<span class="hljs-string">'tweet'</span>])
</code></pre>
<p>:::</p>
<p>::: {.cell .markdown}
<strong>Model Building and Evaluation through Cross Validation</strong>
:::</p>
<p>::: {.cell .markdown}
Our vectors are big and pushing our weights toward 0 without completely
discounting different words thus using Ridge regression would be
advisable
:::</p>
<p>::: {.cell .code execution_count=&quot;69&quot;}</p>
<pre><code class="lang-python"><span class="hljs-attr">clf</span> = linear_model.RidgeClassifier()
</code></pre>
<p>:::</p>
<p>::: {.cell .code execution_count=&quot;70&quot;}</p>
<pre><code class="lang-python">#Using Cross Validation <span class="hljs-keyword">to</span> see how our <span class="hljs-built_in">data</span> would perform <span class="hljs-keyword">on</span> unseen (the test <span class="hljs-built_in">data</span>)

scores = model_selection.cross_val_score( clf, train_vectors, train_dis<span class="hljs-meta">[</span><span class="hljs-string">'target'</span><span class="hljs-meta">]</span>
,cv = 10, scoring = "f1")
scores
</code></pre>
<p>::: {.output .execute_result execution_count=&quot;70&quot;}
    array([0.55909944, 0.36681223, 0.39308176, 0.35343619, 0.4772118 ,
           0.48358209, 0.46231156, 0.42176871, 0.57676903, 0.63433814])
:::
:::</p>
<p>::: {.cell .markdown}
The return score is F1, a combonation of precision call on each of the
folds created during cross validation specified by \&#39;cv\&#39;. The model
isnt that bad as it would achieve atleast 0.63 Theres room for
improvement using better models such as the Logistic Regression using
TFIFD as the vectorizer</p>
<p>The TFIFD model is a numerical statistic used to evaluate how important
a word is to a document in a collection or corpus. It is often used as a
weighting factor in information retrieval and text mining.</p>
<p>The basic idea behind TF-IDF is that words that appear frequently in a
document are important, but words that appear frequently in many
documents across the corpus are not as important. The \&quot;TF\&quot; component
represents the term frequency, or the number of times a word appears in
a document. The \&quot;IDF\&quot; component represents the inverse document
frequency, or the number of documents in the corpus divided by the
number of documents containing the word.</p>
<p>The final TF-IDF score for a word in a document is the product of its
term frequency and inverse document frequency. This score can then be
used to rank the importance of words in a document and to determine the
most relevant words for a given query.</p>
<p>We will switch to a TFIDF model to see how the score improves
:::</p>
<p>::: {.cell .markdown}
<strong>Using TFIDF vectorizer with Logistic Regression model</strong>
:::</p>
<p>::: {.cell .code execution_count=&quot;78&quot;}</p>
<pre><code class="lang-python">from sklearn.feature_extraction.text <span class="hljs-built_in">import</span> TfidfVectorizer
from sklearn.linear_model <span class="hljs-built_in">import</span> LogisticRegression
from sklearn.model_selection <span class="hljs-built_in">import</span> train_test_split
from sklearn.metrics <span class="hljs-built_in">import</span> accuracy_score,f1_score

<span class="hljs-comment">#The input data</span>
<span class="hljs-attr">corpus</span> = train_dis[<span class="hljs-string">"tweet"</span>]
<span class="hljs-attr">labels</span> = test_dis[<span class="hljs-string">"target"</span>]

<span class="hljs-comment"># Split the data into training and test sets</span>
X_train,X_test,y_train,<span class="hljs-attr">y_test</span> = train_test_split(corpus,labels,<span class="hljs-attr">test_size=0.2,</span> <span class="hljs-attr">random_state=42)</span>


<span class="hljs-comment"># Fit the TF-IDF vectorizer on the training data</span>
<span class="hljs-attr">vectorizer</span> = TfidfVectorizer()
<span class="hljs-attr">X_train_vectorizer=vectorizer.fit_transform(X_train)</span>

<span class="hljs-comment">#Train a logistic Regression model on the vectorized training data</span>
<span class="hljs-attr">classifier</span> = LogisticRegression()
classifier.fit(X_train_vectorizer, y_train)

<span class="hljs-comment">#Vectorize the test data</span>
<span class="hljs-attr">X_test_vectorized</span> = vectorizer.transform(X_test)

<span class="hljs-comment">#Predict the labels</span>
<span class="hljs-attr">y_pred</span> = classifier.predict(X_test_vectorized)

<span class="hljs-comment">#Calculate the accuracy</span>
<span class="hljs-attr">accuracy</span> = accuracy_score(y_test,y_pred)
print(<span class="hljs-string">"Accuracy:"</span>,accuracy)

<span class="hljs-comment">#Calculate the F1 score</span>
<span class="hljs-attr">f1</span> = f1_score(y_test,y_pred, <span class="hljs-attr">average</span> = 'weighted')
print(<span class="hljs-string">"F1 score:"</span>, f1)
</code></pre>
<p>::: {.output .stream .stdout}
    Accuracy: 0.7977675640183848
    F1 score: 0.7964083945530092
:::
:::</p>
<p>::: {.cell .markdown}
The accuracy and F1 score has significantly improved! Logistic
regression seems to have an accuracy of 80% meaning that if the model
was to classify positive tweets, more times than not, 80% will be
correctly positive tweets and vice versa
:::</p>
<p>::: {.cell .code execution_count=&quot;73&quot;}</p>
<pre><code class="lang-python">#finishing the test
submission = pd.read_csv('C:<span class="hljs-symbol">\\</span>sample_submission.csv')
submission.head()
</code></pre>
<p>::: {.output .execute_result execution_count=&quot;73&quot;}</p>
<pre><code class="lang-{=html}"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">b4dbf14b-c918-4e28-90f4-e39192eee74d</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display:none; background-color:#9D6CFF; color:white; width:200px; height:30px; padding-left:5px; border-radius:4px; flex-direction:row; justify-content:space-around; align-items:center;"</span> <span class="hljs-attr">onmouseover</span>=<span class="hljs-string">"this.style.backgroundColor='#BA9BF8'"</span> <span class="hljs-attr">onmouseout</span>=<span class="hljs-string">"this.style.backgroundColor='#9D6CFF'"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"window.commands?.execute('create-mitosheet-from-dataframe-output');"</span>&gt;</span>See Full Dataframe in Mito<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.commands?.hasCommand(<span class="hljs-string">'create-mitosheet-from-dataframe-output'</span>)) <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'b4dbf14b-c918-4e28-90f4-e39192eee74d'</span>).style.display = <span class="hljs-string">'flex'</span> </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">border</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dataframe"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"text-align: right;"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>id<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>target<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>9<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>4<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>11<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>:::
:::</p>
<p>::: {.cell .code execution_count=&quot;74&quot;}</p>
<pre><code class="lang-python"><span class="hljs-selector-id">#Converting</span> the prediction dataset into <span class="hljs-selector-tag">a</span> dataframe
pred = pd.DataFrame({<span class="hljs-string">'target'</span>: y_pred})
<span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(len(pred)</span></span>)

<span class="hljs-selector-id">#Appending</span> the predictions
submission[<span class="hljs-string">'target'</span>] = pred
submission.head()
</code></pre>
<p>::: {.output .stream .stdout}
    1523
:::</p>
<p>::: {.output .execute_result execution_count=&quot;74&quot;}</p>
<pre><code class="lang-{=html}"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">78242d1e-2c81-4868-9c5d-3fa4d6ccb941</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display:none; background-color:#9D6CFF; color:white; width:200px; height:30px; padding-left:5px; border-radius:4px; flex-direction:row; justify-content:space-around; align-items:center;"</span> <span class="hljs-attr">onmouseover</span>=<span class="hljs-string">"this.style.backgroundColor='#BA9BF8'"</span> <span class="hljs-attr">onmouseout</span>=<span class="hljs-string">"this.style.backgroundColor='#9D6CFF'"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"window.commands?.execute('create-mitosheet-from-dataframe-output');"</span>&gt;</span>See Full Dataframe in Mito<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript"> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.commands?.hasCommand(<span class="hljs-string">'create-mitosheet-from-dataframe-output'</span>)) <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'78242d1e-2c81-4868-9c5d-3fa4d6ccb941'</span>).style.display = <span class="hljs-string">'flex'</span> </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">border</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"dataframe"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"text-align: right;"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>id<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>target<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>0.0<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>0.0<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1.0<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>9<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>0.0<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>4<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>11<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>1.0<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p>:::
:::</p>
<p>::: {.cell .code execution_count=&quot;75&quot;}</p>
<pre><code class="lang-python"><span class="hljs-comment">#Extract the file</span>
submission.to_csv(<span class="hljs-string">"sample_submission.csv"</span>,<span class="hljs-keyword">index</span>=<span class="hljs-string">"False"</span>)
</code></pre>
<p>:::</p>
